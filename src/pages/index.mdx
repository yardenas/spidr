---
layout: ../layouts/Layout.astro
title: "SPiDR: A Simple Approach for Zero-Shot Safety in Sim-to-Real Transfer"
description: Safe transfer of RL policies from sim to real.
favicon: /spidr/spiderman.png
---

import { Image } from "astro:assets";

import Layout from "../layouts/Layout.astro";

import Header from "../components/Header.astro";
import TwoColumns from "../components/TwoColumns.astro";
import Video from "../components/Video.astro";
import YouTubeVideo from "../components/YouTubeVideo.astro";
import PDF from "../components/PDF.astro";
import Figure from "../components/Figure.astro";
import LaTeX from "../components/LaTeX.astro";
import SmallCaps from "../components/SmallCaps.astro";
import Splat from "../components/Splat.tsx"

import CodeBlock from "../components/CodeBlock.astro";
export const components = { pre: CodeBlock }

import spidrIdea from "../assets/spidr-idea.svg";
import demoEnvs from "../assets/demo-envs.png";
import simulatedCosts from "../assets/simulated-costs.svg";
import simulatedAll from "../assets/simulated.svg";
import realWorldQuant from "../assets/real-world-safety.svg";
import spidrGo1 from "../assets/spidr.mp4";
import ramuGo1 from "../assets/baseline.mp4";
import spidrRC from "../assets/spidr-rccar.mp4";

<Header
  title={frontmatter.title}
  authors={[
    {
      name: "Yarden As",
      url: "https://yas.pub",
      institution: "ETH Zurich",
    },
    {
      name: "Chengrui Qu",
      url: "https://crqu.github.io/",
      institution: "Caltech",
    },
    {
      name: "Benjamin Unger",
      institution: "ETH Zurich",
    },
    {
      name: "Dongho Kang",
      url: "https://donghokang.net/",
      institution: "ETH Zurich",
    },
    {
      name: "Max van der Hart",
      institution: "ETH Zurich",
    },
    {
      name: "Laixi Shi",
      url: "https://laixishi.github.io/",
      institution: "John Hopkins University",
    },
    {
      name: "Stelian Coros",
      institution: "ETH Zurich",
      url: "https://crl.ethz.ch/people/coros/"
    },
    {
      name: "Adam Wierman",
      institution: "Caltech",
      url: "https://adamwierman.com/"
    },
    {
      name: "Andreas Krause",
      url: "https://las.inf.ethz.ch/krausea",
      institution: "ETH Zurich",
    },
  ]}
  conference="NeurIPS 2025"
  notes={[
  ]}
  links={[
    {
      name: "Code",
      url: "https://github.com/yardenas/safe-learning",
      icon: "mdi:github",
    },
    {
      name: "arXiv",
      url: "https://arxiv.org/abs/2509.18648",
      icon: "academicons:arxiv",
    },{
      name: "Paper",
      url: "https://openreview.net/forum?id=Pe1ypX9gBO",
      icon: "ri:file-pdf-2-line",
    },
  ]}
  />
  

<div class="container mx-auto py-10">
  <div class="flex flex-col lg:flex-row justify-center lg:space-x-4 space-y-4 lg:space-y-0">
    <Image src={spidrIdea} alt="Core idea of SPiDR" class="object-cover w-full h-full" />
  </div>
</div>


We introduce SPiDR (**S**im-to-real via **P**ess**i**mistic **D**omain **R**andomization), a scalable algorithm that closes the gap between simulation and reality without compromising safety. SPiDR uses domain randomization to incorporate the uncertainty about the sim-to-real gap into the safety constraints, making it versatile and highly compatible with existing training pipelines.

We theoretically show that unsafe transfer can be related to large uncertainty about the sim-to-real gap, quantified as the disagreement among next-state predictions from domain-randomized dynamics models. This key idea is illustrated in the figure above, where spikes in uncertainty (e.g. at t = 4.6 and t = 5.3) coincide with unstable or unsafe behaviors, such as stumbling or flipping. Motivated by this insight, we propose to penalize the cost with the uncertainty to achieve safe sim-to-real transfer, leading to the design of SPiDR.


## Domain Randomization is Not Safe
Domain randomization is the de facto method for reliable transfer for simulator to real robots. 
Safety is a key component in robotics, however it is not addressed directly by domain randomization. This means that you can train your robot in simulation, and it may still violate safety constraints (like falling or overusing the motors) when you get to deploy the policy on the real system. Existing methods for safe transfer typically rely on tools from robust optimization, therefore requiring roboticists to significantly alter our beloved domain randomization training pipelines. We started this project with the following question:

> How can we develop a safe sim-to-real reinforcement learning algorithm that practitioners can use without reinventing the wheel?

With that in mind, the first obvious thing to do is check is just using domain randomization can still satisfy safety constraints, even when under distribution shifts. The figure below shows that using domain randomization fails to satisfy safety constraints on a bunch of well-known tasks in Mujoco. In contrast, when using SPiDR, constraints are satisfied across all tasks.
<Figure caption="Domain randomization does not satsify the safety constraints.">
  <Image src={simulatedCosts} alt="Domain randomization does not satisfy safety constraints under mismatches in the dynamics." class="object-cover w-full h-full"/>
</Figure>

## What About Performance?
We saw that by adding pessimis, SPiDR is able to transfer safely. But what if with this added conservatism SPiDR is just safe, but does not really solve the task? In the figure below we show the performance in the y-axis vs. safety in the x-axis (upper-left is better). As shown, among all baselines, SPiDR consistently satisfies the constraints while achieving good performance.
<Figure caption="SPiDR finds good balance between safety and performance">
  <Image src={simulatedAll} alt="SPiDR finds good balance between safety and performance." class="object-cover w-full h-full"/>
</Figure>

## Enough with Mujoco, Show Me Some Real Robots!
In our last experiments, we took SPiDR to the real world, deploying it on a Unitree Go1 robot and a remote-controlled race car, shown below.
<Image src={demoEnvs} alt="Real robots" class="object-cover w-full h-full"/>
In the race car, the robot has to navigate to a goal position while avoiding the tire obstacles. For the Unitree Go1, we put a safety constraint on the robot's joint limits.

Below, we show two trajectories of the Unitree Go1 robot. Both trajectories are conditioned exactly on the same commands, however the one on the left uses SPiDR, while the one on the right uses
a baseline algorithm from the robust RL literature. 
<TwoColumns>
  <div slot="left" class="flex flex-col items-center">
    <h3 class="text-lg font-semibold -mb-10 text-center">SPiDR</h3>
    <Figure caption="SPiDR follows commands while satisfying the safety constraints.">
      <Video source={spidrGo1} />
    </Figure>
  </div>
  <div slot="right" class="flex flex-col items-center">
    <h3 class="text-lg font-semibold -mb-10 text-center">Baseline</h3>
    <Figure caption="Robust safe RL baseline fails to transfer to the real robot.">
      <Video source={ramuGo1} />
    </Figure>
  </div>
</TwoColumns>
Below, we showcase SPiDR using the race car robot.

<Figure caption="SPiDR maintains safety upon deployment.">
    <Video source={spidrRC} />
</Figure>

As shown, in both robotics, SPiDR transfers successfully while maintaining the safety constraint.

Finally, we present the accumulated costs that measure safety on the real robots across five random seeds and for multiple trajectories per seed.
<Figure caption="SPiDR finds good balance between safety and performance">
  <Image src={realWorldQuant} alt="Safety is maintained when deploying on two real robotic systems." class="object-cover w-full h-full"/>
</Figure>
This empirical evaluation demonstrates again that SPiDR achieves good performance while transferring safely to the real robots.


## Cite
```
@inproceedings{
  as2025spidrsimpleapproachzeroshot,
  title={{SP}i{DR}: A Simple Approach for Zero-Shot Safety in Sim-to-Real Transfer},
  author={Yarden As and Chengrui Qu and Benjamin Unger and Dongho Kang and Max van der Hart and Laixi Shi and Stelian Coros and Adam Wierman and Andreas Krause},
  booktitle={International Conference on Neural Information Processing Systems},
  year={2025},
}
```

